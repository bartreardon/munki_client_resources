<!--
Let one display banners, conditional if certain items are visible.
To do this it does a simple parse of the current view and if the app you want is present then it displays the banner.

tghis script uses json that looks something like this
Could be a static file or could be generated from a database - change to whatever you need.

[
    {
        "appName": "Adium",
        "appBannerLink": "/some/banner.png"
    }
]


-->

<script type="text/javascript">
// place in footer_template.html
function getJson(url) {
	var request = new XMLHttpRequest();
	var jsonArray = [];
	
	request.open('GET', url, false);
	request.send(null);
	if (request.status === 200) {
		jsonArray = JSON.parse(request.responseText);
	}
	return jsonArray;
}

var displayedAppList = document.getElementsByClassName('name');
var appsToCheck = getJson('http://your.org/munki_repo/somelist.json')

// not sure which order is more efficient, loops probably need to be reversed.
for (var i = 0; i < displayedAppList.length; i++) {
	for (var p = 0; p < appsToCheck.length; p++) {
	    if (displayedAppList[i].innerHTML.indexOf(appsToCheck[p].appName) > -1){
	    	var bannerDiv = document.getElementsByClassName('stage');
		var extraContent = "<img href=\"#\" alt=\"Branding\" src=\""appsToCheck[p].appBannerLink"\" />";
		bannerDiv[0].innerHTML = extraContent + bannerDiv.innerHTML;
	    }
	}
}
</script>
